name: Check changes

on:
  workflow_call:
    outputs:
      changes: 
        description: "List of changes"
        value: ${{ jobs.check-change.outputs.changes }}
      contains_changes:
        description: "Check if changes are present"
        value: ${{ jobs.check-change.outputs.changes != '[]' }}
jobs:
  check-change:
    runs-on: ubuntu-latest
    outputs:
      changes: ${{ steps.check.outputs.changes }}
    steps:
      - name: Checkout Code
        uses: actions/checkout@v3
      - uses: dorny/paths-filter@v2
        id: check
        with:
          list-files: 'json'
          filters: |
            dir1:
              - 'api/dir1/**'
            dir2:
              - 'api/dir2/**'
            dir3:
              - 'api/dir3/**'
            dir4:
              - 'api/dir4/**'
      - run: |
          echo ${{ steps.check.outputs.dir1 }} 
          echo ${{ steps.check.outputs.dir2 }} 
          echo ${{ steps.check.outputs.dir3 }} 
          echo ${{ steps.check.outputs.dir4 }}
      - run: | 
          echo ${{ steps.check.outputs.changes }}
      - run: |
          echo {"api": ${{ steps.check.outputs.changes }}} > /tmp/json.json
          cat /tmp/json.json
          jq /tmp/json.json
